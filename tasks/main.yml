---
- set_fact:
    ansible_python_interpreter: /usr/bin/python2.7

- raw: >-
    test -e {{ ansible_python_interpreter }}
    || ( sudo yum makecache -y && sudo yum install -y python2 )
    || echo "No yum. Kthxbye."

- raw: >-
    test -e {{ ansible_python_interpreter }}
    || ( sudo apt-get update -y && sudo apt-get install -y python2.7 )
    || echo "No apt-get. Kthxbye."

- setup:

- set_fact:
    dist_name: "{{ ansible_distribution|lower }}"
    dist_version: "{{ ansible_distribution_major_version }}"

- debug:
    msg: >-
      Detected: {{ dist_name }} {{ dist_version }}

- include: "{{ dist_name }}/{{ dist_name }}_{{ dist_version }}.yml"

- pip:
    name: ansible
    state: latest